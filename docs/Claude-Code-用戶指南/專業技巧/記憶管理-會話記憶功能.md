# 記憶管理-會話記憶功能

## 文章資訊
- 文章原始標題：榨干 Claude Code 的 16 個實用小技巧（高端玩法，建議收藏！）
- 文章網址：https://www.cnblogs.com/javastack/p/18978280

## 文章原始內容

10. 記憶管理
- 支持項目級和用戶級記憶文件
- 可通過 `/memory` 編輯記憶文件

9. 恢復歷史會話
- 非交互模式：`claude --continue`
- 交互模式：`/resume`

## 功能分析與使用建議

### 記憶管理系統概述
Claude Code 提供了強大的記憶管理功能，能夠在會話間保持上下文資訊，包括專案特定的設定、開發偏好、和歷史決策記錄。

### 記憶文件層級

#### 用戶級記憶（全域記憶）
**位置**：`~/.claude/memory.md`

**用途**：
- 個人編程偏好
- 常用的代碼風格
- 經常使用的工具和框架
- 全域的開發規範

**範例內容**：
```markdown
# 用戶記憶文件

## 編程偏好
- 優先使用 TypeScript 而不是 JavaScript
- 偏好函數式編程風格
- 使用 2 空格縮排
- 喜歡詳細的錯誤處理

## 常用工具
- 測試框架：Jest + React Testing Library
- 狀態管理：Redux Toolkit
- CSS 框架：Tailwind CSS
- 打包工具：Vite

## 開發習慣
- 先寫測試再實現功能
- 每個函數都要有 JSDoc 註釋
- 使用 conventional commits 格式
- 定期重構以保持代碼整潔
```

#### 專案級記憶（專案記憶）
**位置**：`{project_root}/.claude/memory.md`

**用途**：
- 專案特定的架構決策
- 技術債務記錄
- 重要的業務邏輯說明
- 專案特定的開發規範

**範例內容**：
```markdown
# 專案記憶文件

## 架構決策
- 使用微服務架構，每個服務獨立部署
- 資料庫使用 PostgreSQL
- 快取層使用 Redis
- 訊息佇列使用 RabbitMQ

## 重要業務規則
- 用戶密碼必須包含大小寫字母、數字和特殊字符
- 訂單狀態變更必須記錄審計日誌
- 敏感資料必須加密存儲

## 已知問題
- Auth 服務在高併發時會有性能瓶頸
- 支付模組需要重構以支持多幣種
- 搜索功能使用 Elasticsearch，索引需要定期更新

## 開發規範
- API 路由使用 RESTful 設計
- 所有 API 都需要版本控制
- 錯誤訊息使用統一的格式
```

### 記憶管理操作

#### 編輯記憶文件
```bash
# 在互動模式中編輯記憶文件
/memory

# 這會開啟編輯器讓你修改當前的記憶文件
```

#### 查看記憶內容
```bash
# 查看當前記憶狀態
請顯示當前的記憶設定

# 確認記憶是否正確記錄
請確認你記住了我們專案的架構決策
```

#### 更新記憶內容
```bash
# 添加新的記憶
請記住：這個專案使用 Clean Architecture 模式

# 修正記憶內容
請更新記憶：我們已經從 MySQL 遷移到 PostgreSQL

# 刪除過時的記憶
請忘記關於舊版 API 的記憶，我們已經完全重構了
```

### 會話恢復功能

#### 非互動模式恢復
```bash
# 恢復上一次的會話
claude --continue

# 恢復並執行新任務
claude --continue "請繼續昨天的重構工作"
```

#### 互動模式恢復
```bash
# 在互動模式中恢復會話
/resume

# 恢復特定的會話
/resume --session 20240101-123456
```

### 實際應用場景

#### 長期專案開發
```markdown
# 第一天的會話
開發者: 請幫我設計一個電商系統的用戶模組
Claude: [設計用戶模組並記錄架構決策]

# 第二天的會話  
開發者: /resume
Claude: 歡迎回來！昨天我們討論了電商系統的用戶模組設計...
開發者: 現在請幫我實現用戶註冊功能
Claude: [基於昨天的設計實現註冊功能]
```

#### 團隊協作場景
```markdown
# 團隊成員 A 的記憶
## 負責模組
- 用戶認證和授權
- 支付模組

# 團隊成員 B 的記憶  
## 負責模組
- 商品管理
- 訂單處理
```

#### 學習和實驗記錄
```markdown
# 學習記憶
## 已掌握的技術
- React Hooks 基礎用法
- TypeScript 基本語法
- Jest 單元測試

## 正在學習的內容
- Next.js 服務端渲染
- GraphQL API 設計
- Docker 容器化部署

## 下一步學習計劃
- Kubernetes 集群管理
- 微服務架構模式
```

### 記憶管理最佳實踐

#### 保持記憶文件整潔
```markdown
# 定期整理記憶文件
## 重要決策 (保留)
- 核心架構設計
- 重要的業務規則
- 長期的技術選擇

## 臨時資訊 (定期清理)
- 已完成的任務記錄  
- 已解決的問題
- 過時的技術細節
```

#### 結構化記憶內容
```markdown
# 使用統一的格式
## 架構決策
### 決策：選擇 React 作為前端框架
- 原因：團隊熟悉度高，生態系統完善
- 影響：需要學習 React 生態的最佳實踐
- 日期：2024-01-15

## 技術債務
### 問題：用戶認證邏輯分散在多個文件中
- 影響：維護困難，容易出現一致性問題
- 優先級：高
- 計劃解決時間：2024-02-01
```

#### 版本控制記憶文件
```bash
# 將專案記憶文件納入版本控制
git add .claude/memory.md
git commit -m "Update project memory with new architecture decisions"

# 但排除個人記憶文件
echo ".claude/personal-memory.md" >> .gitignore
```

### 高級記憶技巧

#### 情境相關記憶
```markdown
# 根據開發階段調整記憶重點

## 專案初期
- 重點記錄架構決策
- 記錄技術選型理由
- 記錄團隊約定的規範

## 開發階段
- 重點記錄遇到的問題和解決方案
- 記錄重要的業務邏輯
- 記錄效能優化的經驗

## 維護階段
- 重點記錄常見問題的解決方法
- 記錄系統的已知限制
- 記錄監控和運維相關資訊
```

#### 條件性記憶觸發
```bash
# 根據專案類型自動載入相關記憶
if [[ -f "package.json" ]]; then
    echo "檢測到 Node.js 專案，載入相關開發規範..."
elif [[ -f "requirements.txt" ]]; then
    echo "檢測到 Python 專案，載入相關開發規範..."
fi
```

### 注意事項

1. **隱私保護**：不要在記憶中儲存敏感資訊
2. **定期維護**：清理過時和無關的記憶內容
3. **團隊協作**：確保團隊成員了解共享記憶的內容
4. **備份重要記憶**：定期備份重要的記憶文件
5. **記憶一致性**：確保不同層級記憶間沒有衝突