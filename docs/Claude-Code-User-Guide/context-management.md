# 上下文管理-保持焦點

## 文章資訊
- 文章原始標題：Claude Code Best Practices
- 文章網址：https://www.anthropic.com/engineering/claude-code-best-practices

## 文章原始內容

在長會話期間，Claude 的上下文視窗可能會填滿不相關的對話、檔案內容和指令。這可能會降低性能，有時還會分散 Claude 的注意力。在任務之間頻繁使用 /clear 指令來重置上下文視窗。

## 功能分析與使用建議

上下文管理是 Claude Code 高效運作的關鍵要素，直接影響 AI 的理解能力、響應品質和運作效率：

### 1. 上下文視窗的挑戰

**容量限制問題**：
- **累積效應**：對話歷史、檔案內容、指令結果持續累積
- **性能下降**：過滿的上下文導致回應品質降低
- **注意力分散**：不相關的歷史資訊干擾當前任務焦點
- **自動壓縮風險**：系統自動壓縮可能丟失重要上下文

**識別信號**：
- 右下角出現上下文視窗警告通知
- Claude 回應品質明顯下降
- 處理時間顯著增加
- 開始引用過時或不相關的資訊

### 2. /clear 指令的戰略運用

**最佳時機**：
- **任務轉換**：從一個功能開發轉向另一個功能
- **階段完成**：完成探索階段，準備進入編碼階段
- **錯誤重置**：當 Claude 陷入錯誤思維模式時
- **專注需求**：需要 Claude 專注於特定問題時

**使用策略**：
```bash
# 功能完成後清理
> 已完成用戶認證模組，請提交程式碼
> /clear
> 現在開始開發支付模組

# 探索階段結束後重置
> 已了解現有架構，請制定重構計劃
> /clear  
> 基於剛才的探索，請實施以下重構計劃...
```

### 3. 預防性上下文管理

**會話範圍界定**：
- **單一專案原則**：每個會話專注於一個專案或功能
- **功能邊界**：避免在單一會話中處理多個不相關功能
- **時間限制**：長時間會話應主動分割

**資訊精簡策略**：
- **選擇性檔案載入**：只載入當前任務相關的檔案
- **摘要替代**：用摘要替代完整的長文檔
- **階段性清理**：在每個主要階段後清理無關內容

### 4. 高效上下文策略

**分層管理法**：
```
層級 1: 核心配置 (CLAUDE.md) - 持續保留
層級 2: 當前任務上下文 - 任務期間保留  
層級 3: 暫時性資訊 - 使用後立即清理
層級 4: 實驗性內容 - 快速驗證後清理
```

**上下文檢查點**：
- **文檔化關鍵決策**：將重要決策記錄在外部文件
- **狀態快照**：定期儲存當前狀態到檔案系統
- **恢復點設置**：為複雜任務建立可恢復的檢查點

### 5. 進階上下文技巧

**智能重載**：
```bash
# 保存重要上下文到文件
> 請將當前的架構決策記錄到 architecture-decisions.md
> /clear
> 請讀取 architecture-decisions.md，繼續基於這些決策進行開發
```

**上下文傳遞**：
- **文件媒介**：通過檔案系統在清理前後傳遞資訊
- **結構化記錄**：使用標準格式記錄重要狀態
- **版本追蹤**：結合 Git 提交記錄上下文變化

### 6. 團隊協作中的上下文管理

**共享上下文策略**：
- **CLAUDE.md 同步**：確保團隊成員使用一致的基礎上下文
- **會話記錄**：關鍵決策和討論過程的文檔化
- **知識累積**：將有價值的上下文整合到專案文檔

**協作模式**：
```bash
# 會話交接模式
開發者 A: > 請將當前進度記錄到 session-handoff.md
           > /clear
開發者 B: > 請讀取 session-handoff.md，繼續這個任務
```

### 7. 性能優化指標

**監控要素**：
- **回應時間**：上下文過載時回應變慢
- **回應品質**：內容相關性和準確度
- **記憶一致性**：是否能正確記住重要資訊
- **指令遵循**：對特定指令的執行精確度

**優化週期**：
- **即時調整**：發現問題立即使用 /clear
- **定期清理**：每30分鐘主動評估上下文狀態
- **任務導向**：基於任務複雜度調整清理頻率

上下文管理是 Claude Code 高效使用的基石，通過主動和策略性的管理，可以確保 AI 助手始終保持最佳狀態，為開發工作提供持續的高品質支援。